#pragma once

#include "core/array.h"
#include "core/sphere.h"

namespace Lumix
{
	namespace MTJD
	{
		class Manager;
	}
	class Frustum;

	class LUMIX_RENDERER_API CullingSystem
	{
	public:
		typedef Array<Sphere> InputSpheres;
		typedef Array<int> Subresults;
		typedef Array<Subresults> Results;

		CullingSystem() { }
		virtual ~CullingSystem() { }

		static CullingSystem* create(MTJD::Manager& mtjd_manager, IAllocator& allocator);
		static void destroy(CullingSystem& culling_system);

		virtual void clear() = 0;
		virtual const Results& getResult() = 0;

		virtual void cullToFrustum(const Frustum& frustum, int64 layer_mask) = 0;
		virtual void cullToFrustumAsync(const Frustum& frustum, int64 layer_mask) = 0;

		virtual void addStatic(const Sphere& sphere) = 0;
		virtual void removeStatic(int index) = 0;

		virtual void setLayerMask(int index, int64 layer) = 0;
		virtual int64 getLayerMask(int index) = 0;

		virtual void enableStatic(int index) = 0;
		virtual void disableStatic(int index) = 0;

		virtual void updateBoundingRadius(float radius, int index) = 0;
		virtual void updateBoundingPosition(const Vec3& position, int index) = 0;

		virtual void insert(const InputSpheres& spheres) = 0;
		virtual const InputSpheres& getSpheres() = 0;
	};
} // ~namespace Lux